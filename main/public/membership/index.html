<!DOCTYPE html>
<html lang="en">
<head>
  
  <meta charset="UTF-8" />
  <!-- CSP FIX (one change): allow favicon/images from self + https + data -->
  <meta http-equiv="Content-Security-Policy" content="img-src 'self' data: https:;">

  <title>Rozenrust Tennis Club – Membership</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Tailwind config (must come BEFORE the Tailwind CDN script) -->
  <script>
    tailwind = {
      config: {
        theme: {
          extend: {
            colors: {
              "tennis-green": "#2d4a22" /* green-600 */
            }
          }
        }
      }
    };
  </script>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

  <!-- Stripe.js (client library) -->
  <script src="https://js.stripe.com/v3/"></script>

  <!-- React 18 (use ReactDOM.render to avoid ReactDOMClient issues) -->
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js"></script>

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Babel (to support TSX in browser) -->
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone/babel.min.js"></script>

  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
    h1, h2, h3 { font-family: 'Playfair Display', serif; }

    /* Your app uses these non-tailwind classnames; define them here */
    .tennis-green { background-color: #2d4a22; }
    .tennis-green-hover:hover { background-color: #243b1b; } /* darker hover */
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel" data-presets="react">
    (() => {
      /*************************
       * CONSTANTS (from constants.ts)
       *************************/
      const STRIPE_PUBLISHABLE_KEY = "pk_test_51Sg0TnECh0opYVDDRd5hbKvwnhz4nDjEkLpJPfkMz0YuairALPfH16Mxp0F0GzzpM5tODXrl2csHKu63a89NxkjO00WnxAgYzH";
      const STRIPE_SECRET_KEY = "sk_test_51Sg0TnECh0opYVDDGsHfzr4qc3pvW5UygFx1OJt6egGsC0O3FjE6NwwNwujGeQcDA0PY82zAeqIYGbM4NYaujZTM00Dit0gtlD";

      const SUPABASE_URL = "https://lxxbcaofukuouytqwmav.supabase.co";
      const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imx4eGJjYW9mdWt1b3V5dHF3bWF2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4ODE2MTEsImV4cCI6MjA4MTQ1NzYxMX0.NKlylGJDAit-MOpylK03htN6f9yF_ekA3dtnslQJio4";

      const FEES = {
        Annual: { "Senior 60+": 30, "Senior": 20, "Student": 10, "Social": 5 },
        Seasonal: { "Senior 60+": 15, "Senior": 9, "Student": 7, "Social": 3 },
      };

      const TEXT = {
        length: { en: "1. Membership Length", nl: "1. Lidmaatschapsduur" },
        type: { en: "2. Membership Type", nl: "2. Lidmaatschapstype" },
        info: { en: "3. Personal Information", nl: "3. Persoonlijke Informatie" },
        addressSec: { en: "4. Address", nl: "4. Adres" },
        paymentSec: { en: "5. Payment Details", nl: "5. Betaalgegevens" },
        annual: { en: "Annual", nl: "Jaarlijks" },
        seasonal: { en: "Seasonal", nl: "Seizoensgebonden" },
        firstName: { en: "First Name", nl: "Voornaam" },
        lastName: { en: "Last Name", nl: "Achternaam" },
        dob: { en: "Date of Birth", nl: "Geboortedatum" },
        year: { en: "Year", nl: "Jaar" },
        month: { en: "Month", nl: "Maand" },
        day: { en: "Day", nl: "Dag" },
        street: { en: "Street", nl: "Straat" },
        houseNumber: { en: "No.", nl: "Huisnr." },
        postcode: { en: "Postcode", nl: "Postcode" },
        city: { en: "City", nl: "Stad" },
        email: { en: "Email Address", nl: "E-mailadres" },
        phone: { en: "Phone Number (Optional)", nl: "Telefoonnummer (Optioneel)" },
        total: { en: "Total Amount to Pay", nl: "Totaal te Betalen Bedrag" },
        totalPaid: { en: "Total amount paid", nl: "Totaal betaald bedrag" },
        cardNumber: { en: "Credit or Debit Card", nl: "Creditcard of Pinpas" },
        payButton: { en: "Pay Membership Fee", nl: "Lidmaatschapsgeld Betalen" },
        successTitle: { en: "Welcome to the Club!", nl: "Welkom bij de Club!" },
        successMsg: { en: "Your membership has been activated successfully.", nl: "Uw lidmaatschap is succesvol geactiveerd." },
        processing: { en: "Processing Payment...", nl: "Betaling Verwerken..." },
        failed: { en: "Payment Failed", nl: "Betaling Mislukt" },
        requiredError: { en: "This field is required", nl: "Dit veld is verplicht" },
        invalidEmail: { en: "Invalid email address", nl: "Ongeldig e-mailadres" },
        duplicateEmail: { en: "Email already registered", nl: "E-mail al geregistreerd" },
        numberError: { en: "Numbers are not allowed", nl: "Cijfers zijn niet toegestaan" },
        placeholders: {
          firstName: "e.g. John / bijv. Jan",
          lastName: "e.g. Doe / bijv. de Vries",
          street: "e.g. Main St / bijv. Hoofdstraat",
          houseNumber: "12A",
          postcode: "1234 AB",
          city: "Amsterdam",
          email: "john@example.com",
          phone: "+31 6 12345678",
        }
      };

      /*************************
       * SUPABASE (important: avoid naming collision with global window.supabase)
       *************************/
      const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

      /*************************
       * COMPONENTS (from components/)
       *************************/
      const LanguageLabel = ({ en, nl, className = "", required = false }) => {
        return (
          <div className={`flex flex-col mb-1 ${className}`}>
            <span className="text-sm font-semibold text-gray-700">
              {en} / {nl}
              {required && <span className="text-red-500 ml-1">*</span>}
            </span>
          </div>
        );
      };

      const InputField = ({
        en, nl, value, onChange, error, required, placeholder, type = "text", maxLength
      }) => {
        return (
          <div className="w-full">
            <LanguageLabel en={en} nl={nl} required={required} />
            <input
              type={type}
              value={value}
              onChange={(e) => onChange(e.target.value)}
              placeholder={placeholder}
              maxLength={maxLength}
              className={`w-full p-2.5 border rounded-md focus:ring-2 focus:ring-tennis-green outline-none transition-all bg-white text-black placeholder-gray-400 ${
                error ? "border-red-500 ring-1 ring-red-500" : "border-gray-300 shadow-sm"
              }`}
            />
            {error && <p className="text-red-600 text-xs mt-1 font-bold animate-pulse">{error}</p>}
          </div>
        );
      };

      /*************************
       * APP (adapted from App.tsx to run standalone)
       *************************/
      const App = () => {
        const [appState, setAppState] = React.useState("IDLE"); // IDLE | PROCESSING | SUCCESS | FAILED
        const [length, setLength] = React.useState("Annual");   // Annual | Seasonal
        const [type, setType] = React.useState("Senior");       // Senior 60+ | Senior | Student | Social

        const [userData, setUserData] = React.useState({
          firstName: "",
          lastName: "",
          dobYear: "",
          dobMonth: "",
          dobDay: "",
          street: "",
          houseNumber: "",
          postcode: "",
          city: "",
          email: "",
          phone: ""
        });

        const [errors, setErrors] = React.useState({});
        const [paymentErrorMessage, setPaymentErrorMessage] = React.useState("");
        const [finalRecord, setFinalRecord] = React.useState(null);

        const stripeRef = React.useRef(null);
        const cardElementRef = React.useRef(null);
        const elementsRef = React.useRef(null);

        React.useEffect(() => {
          if (appState !== "SUCCESS" && window.Stripe) {
            if (!stripeRef.current) {
              stripeRef.current = window.Stripe(STRIPE_PUBLISHABLE_KEY);
            }
            if (!elementsRef.current) {
              elementsRef.current = stripeRef.current.elements();
            }

            const mountStripe = () => {
              const cardElementContainer = document.getElementById("stripe-card-element");
              if (cardElementContainer && !cardElementRef.current) {
                const style = {
                  base: {
                    fontSize: "16px",
                    color: "#1a1a1a",
                    fontFamily: "Inter, sans-serif",
                    "::placeholder": { color: "#9ca3af" },
                  },
                  invalid: { color: "#ef4444", iconColor: "#ef4444" },
                };
                cardElementRef.current = elementsRef.current.create("card", {
                  style,
                  hidePostalCode: true
                });
                cardElementRef.current.mount("#stripe-card-element");
              }
            };

            const timeout = setTimeout(mountStripe, 100);
            return () => clearTimeout(timeout);
          }

          return () => {
            if (appState === "SUCCESS" && cardElementRef.current) {
              cardElementRef.current.destroy();
              cardElementRef.current = null;
            }
          };
        }, [appState]);

        const fee = FEES[length][type];

        const validateAll = async () => {
          const newErrors = {};
          const hasNumber = /\d/;

          if (!userData.firstName) newErrors.firstName = `${TEXT.requiredError.en} / ${TEXT.requiredError.nl}`;
          else if (hasNumber.test(userData.firstName)) newErrors.firstName = `${TEXT.numberError.en} / ${TEXT.numberError.nl}`;

          if (!userData.lastName) newErrors.lastName = `${TEXT.requiredError.en} / ${TEXT.requiredError.nl}`;
          else if (hasNumber.test(userData.lastName)) newErrors.lastName = `${TEXT.numberError.en} / ${TEXT.numberError.nl}`;

          if (!userData.dobYear || !userData.dobMonth || !userData.dobDay) {
            newErrors.dob = `${TEXT.requiredError.en} / ${TEXT.requiredError.nl}`;
          }

          if (!userData.street) newErrors.street = `${TEXT.requiredError.en} / ${TEXT.requiredError.nl}`;
          if (!userData.houseNumber) newErrors.houseNumber = `${TEXT.requiredError.en} / ${TEXT.requiredError.nl}`;
          if (!userData.postcode) newErrors.postcode = `${TEXT.requiredError.en} / ${TEXT.requiredError.nl}`;
          if (!userData.city) newErrors.city = `${TEXT.requiredError.en} / ${TEXT.requiredError.nl}`;

          if (!userData.email) {
            newErrors.email = `${TEXT.requiredError.en} / ${TEXT.requiredError.nl}`;
          } else if (!userData.email.includes("@")) {
            newErrors.email = `${TEXT.invalidEmail.en} / ${TEXT.invalidEmail.nl}`;
          } else {
            // duplicate email check
            try {
              const { data, error } = await sb
                .from("members")
                .select("id")
                .eq("email", userData.email.toLowerCase())
                .maybeSingle();

              if (error) throw error;
              if (data) newErrors.email = `${TEXT.duplicateEmail.en} / ${TEXT.duplicateEmail.nl}`;
            } catch (err) {
              console.error("Database check error:", err);
            }
          }

          setErrors(newErrors);

          if (Object.keys(newErrors).length > 0) {
            const firstErrorKey = Object.keys(newErrors)[0];
            const fieldId = firstErrorKey === "dob" ? "field-dob" : `field-${firstErrorKey}`;
            const element = document.getElementById(fieldId);
            element?.scrollIntoView({ behavior: "smooth", block: "center" });
            return false;
          }
          return true;
        };

        const handleProcessPayment = async () => {
          if (appState === "PROCESSING") return;

          setErrors({});
          const isValid = await validateAll();
          if (!isValid) return;

          setAppState("PROCESSING");

          try {
            /**
             * WARNING:
             * Calling Stripe's secret API directly from the browser will often fail due to CORS,
             * and exposes your secret key publicly (even if test mode).
             * You said Option B for now — this keeps your logic as-is for UI testing.
             */
            const response = await fetch("https://api.stripe.com/v1/payment_intents", {
              method: "POST",
              headers: {
                "Authorization": `Bearer ${STRIPE_SECRET_KEY}`,
                "Content-Type": "application/x-www-form-urlencoded"
              },
              body: new URLSearchParams({
                amount: (fee * 100).toString(),
                currency: "eur",
                description: `Membership: ${length} - ${type}`,
                "receipt_email": userData.email
              })
            });

            const paymentIntent = await response.json();
            if (paymentIntent.error) throw new Error(paymentIntent.error.message);

            if (!cardElementRef.current) {
              throw new Error("Payment field was not loaded correctly. Please refresh.");
            }

            const result = await stripeRef.current.confirmCardPayment(paymentIntent.client_secret, {
              payment_method: {
                card: cardElementRef.current,
                billing_details: {
                  name: `${userData.firstName} ${userData.lastName}`,
                  email: userData.email,
                },
              },
            });

            if (result.error) throw new Error(result.error.message);

            if (result.paymentIntent.status === "succeeded") {
              const membershipNumber = `RR-${Math.floor(10000 + Math.random() * 90000)}`;

              const startDate = new Date();
              const expiryDate = new Date();
              if (length === "Annual") expiryDate.setFullYear(startDate.getFullYear() + 1);
              else expiryDate.setMonth(startDate.getMonth() + 6);

              const userEmail = userData.email.toLowerCase();

              // 3) members
              const { data: newlyCreated, error: createError } = await sb
                .from("members")
                .insert({
                  email: userEmail,
                  first_name: userData.firstName,
                  last_name: userData.lastName,
                  dob_year: userData.dobYear,
                  dob_month: userData.dobMonth,
                  dob_day: userData.dobDay,
                  street: userData.street,
                  house_number: userData.houseNumber,
                  postcode: userData.postcode,
                  city: userData.city,
                  phone: userData.phone
                })
                .select("id")
                .single();

              if (createError) throw new Error(`Member Creation Error: ${createError.message}`);

              const memberId = newlyCreated.id;

              // 4) memberships
              const { data: msData, error: msError } = await sb
                .from("memberships")
                .insert({
                  member_id: memberId,
                  membership_type: type,
                  membership_length: length,
                  membership_number: membershipNumber,
                  start_date: startDate.toISOString(),
                  expires_at: expiryDate.toISOString(),
                  status: "active"
                })
                .select("id")
                .single();

              if (msError) throw new Error(`Membership Creation Error: ${msError.message}`);

              const membershipId = msData.id;

              // 5) payments_transactions
              const { error: pError } = await sb
                .from("payments_transactions")
                .insert({
                  member_id: memberId,
                  membership_id: membershipId,
                  stripe_id: result.paymentIntent.id,
                  amount: fee,
                  status: "completed",
                  payment_date: new Date().toISOString()
                });

              if (pError) console.warn("Transaction Record Error (Non-Critical):", pError.message);

              const record = {
                ...userData,
                membershipNumber,
                membershipType: type,
                membershipLength: length,
                amountPaid: fee,
                paymentDate: new Date().toLocaleDateString()
              };

              setFinalRecord(record);
              setAppState("SUCCESS");
              window.scrollTo({ top: 0, behavior: "smooth" });
            }
          } catch (err) {
            console.error("Critical Registration Error:", err);
            setPaymentErrorMessage(err?.message || "An unexpected error occurred during registration.");
            setAppState("FAILED");
          }
        };

        const handleReset = () => {
          setAppState("IDLE");
          setUserData({
            firstName: "", lastName: "", dobYear: "", dobMonth: "", dobDay: "",
            street: "", houseNumber: "", postcode: "", city: "", email: "", phone: ""
          });
          setErrors({});
          setFinalRecord(null);
          setPaymentErrorMessage("");
          window.scrollTo({ top: 0, behavior: "smooth" });
        };

        const years = Array.from({ length: 100 }, (_, i) => (new Date().getFullYear() - i).toString());
        const months = Array.from({ length: 12 }, (_, i) => String(i + 1).padStart(2, "0"));
        const days = Array.from({ length: 31 }, (_, i) => String(i + 1).padStart(2, "0"));

        if (appState === "SUCCESS" && finalRecord) {
          return (
            <div className="min-h-screen bg-gray-50 flex items-center justify-center p-4">
              <div className="bg-white rounded-2xl shadow-2xl p-8 md:p-12 text-center border-t-8 border-tennis-green max-w-2xl w-full">
                <div className="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
                  <svg className="w-12 h-12 text-tennis-green" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="3" d="M5 13l4 4L19 7" />
                  </svg>
                </div>

                <h2 className="text-4xl font-bold text-tennis-green mb-2">{TEXT.successTitle.en}</h2>
                <p className="text-gray-600 mb-8">{TEXT.successMsg.en} / {TEXT.successMsg.nl}</p>

                <div className="bg-gray-50 rounded-lg p-8 text-left space-y-4 border border-gray-100 shadow-inner">
                  <h4 className="font-bold text-gray-800 border-b pb-3 flex justify-between items-center">
                    <span>Receipt / Factuur</span>
                    <span className="text-tennis-green font-mono">{finalRecord.membershipNumber}</span>
                  </h4>

                  <div className="grid grid-cols-2 gap-y-3 text-sm">
                    <span className="text-gray-500">{TEXT.firstName.en} / {TEXT.firstName.nl}:</span>
                    <span className="font-semibold text-right text-black">{finalRecord.firstName}</span>

                    <span className="text-gray-500">{TEXT.lastName.en} / {TEXT.lastName.nl}:</span>
                    <span className="font-semibold text-right text-black">{finalRecord.lastName}</span>

                    <span className="text-gray-500">{TEXT.type.en} / {TEXT.type.nl}:</span>
                    <span className="font-semibold text-right text-black">{finalRecord.membershipType}</span>

                    <div className="col-span-2 border-t pt-4 mt-2 flex justify-between items-center">
                      <span className="text-gray-800 font-bold">{TEXT.totalPaid.en} / {TEXT.totalPaid.nl}:</span>
                      <span className="font-bold text-2xl text-tennis-green">€{finalRecord.amountPaid},00</span>
                    </div>
                  </div>
                </div>

                <button
                  onClick={handleReset}
                  className="mt-10 w-full tennis-green text-white py-4 rounded-lg font-bold tennis-green-hover transition-all shadow-lg hover:shadow-xl transform active:scale-[0.98]"
                >
                  Done / Klaar
                </button>
              </div>
            </div>
          );
        }

        return (
          <div className="min-h-screen pb-20 bg-gray-50">
            <header className="tennis-green py-12 px-4 shadow-xl text-center mb-8 sticky top-0 z-[60]">
              <h1 className="text-white text-4xl md:text-6xl font-bold mb-3 tracking-tight">Rozenrust Tennis Club</h1>
              <p className="text-white/80 text-lg md:text-xl font-medium tracking-wide">
                Membership Registration / Lidmaatschapsregistratie
              </p>
            </header>

            <main className="max-w-3xl mx-auto px-4 relative">
              {appState === "PROCESSING" && (
                <div className="fixed inset-0 z-[100] bg-white/70 backdrop-blur-sm flex flex-col items-center justify-center">
                  <div className="w-20 h-20 border-8 border-tennis-green/20 border-t-tennis-green rounded-full animate-spin mb-8"></div>
                  <h2 className="text-3xl font-bold text-tennis-green mb-2">{TEXT.processing.en}</h2>
                  <p className="text-gray-600 font-medium">{TEXT.processing.nl}</p>
                </div>
              )}

              <div className={`space-y-10 transition-all duration-500 ${appState === "PROCESSING" ? "opacity-20 blur-sm pointer-events-none" : "opacity-100"}`}>
                <div className="bg-white rounded-3xl shadow-2xl border border-gray-100 overflow-hidden">
                  <div className="p-6 md:p-12 space-y-16">

                    <section id="section-length" className="scroll-mt-40">
                      <div className="border-l-8 border-tennis-green pl-6">
                        <LanguageLabel en={TEXT.length.en} nl={TEXT.length.nl} required className="text-xl" />
                      </div>

                      <div className="grid grid-cols-2 gap-6 mt-6">
                        {["Annual", "Seasonal"].map((l) => (
                          <button
                            key={l}
                            onClick={() => setLength(l)}
                            className={`p-6 border-2 rounded-2xl text-left transition-all relative overflow-hidden group ${
                              length === l
                                ? "tennis-green border-tennis-green text-white shadow-xl ring-4 ring-tennis-green/10"
                                : "bg-white border-gray-200 text-black hover:border-tennis-green/50 hover:bg-tennis-green/5"
                            }`}
                          >
                            <span className="block font-bold text-xl mb-1">{l === "Annual" ? TEXT.annual.en : TEXT.seasonal.en}</span>
                            <span className={`block text-sm ${length === l ? "opacity-80" : "text-gray-500"}`}>{l === "Annual" ? TEXT.annual.nl : TEXT.seasonal.nl}</span>

                            {length === l && (
                              <div className="absolute top-2 right-2">
                                <svg className="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                                  <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                </svg>
                              </div>
                            )}
                          </button>
                        ))}
                      </div>
                    </section>

                    <section id="section-type" className="scroll-mt-40">
                      <div className="border-l-8 border-tennis-green pl-6">
                        <LanguageLabel en={TEXT.type.en} nl={TEXT.type.nl} required className="text-xl" />
                      </div>

                      <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mt-6">
                        {["Senior 60+", "Senior", "Student", "Social"].map((t) => (
                          <button
                            key={t}
                            onClick={() => setType(t)}
                            className={`p-6 border-2 rounded-2xl text-center transition-all group ${
                              type === t
                                ? "tennis-green border-tennis-green text-white font-bold shadow-xl ring-4 ring-tennis-green/10"
                                : "bg-white border-gray-200 text-black hover:border-tennis-green/50 hover:bg-tennis-green/5"
                            }`}
                          >
                            <span className="text-sm font-semibold tracking-wide uppercase block mb-2">{t}</span>
                            <span className="block text-2xl font-black">€{FEES[length][t]}</span>
                          </button>
                        ))}
                      </div>
                    </section>

                    <div className="bg-tennis-green/5 p-8 rounded-3xl border-2 border-dashed border-tennis-green/30 flex justify-between items-center transform transition-transform hover:scale-[1.01]">
                      <div>
                        <h3 className="text-gray-500 text-sm font-bold uppercase tracking-widest mb-1">{TEXT.total.en} / {TEXT.total.nl}</h3>
                        <div className="text-4xl font-black text-tennis-green">€{fee},00</div>
                      </div>
                      <div className="hidden md:block">
                        <svg className="w-12 h-12 text-tennis-green/20" fill="currentColor" viewBox="0 0 24 24">
                          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.97 0-1.92 1.41-3.26 3.11-3.66V3.38h2.67v1.94c1.86.3 2.76 1.45 2.84 3.03h-1.96c-.08-.81-.56-1.46-2.14-1.46-1.64 0-2.12.71-2.12 1.43 0 .97.83 1.5 2.71 1.96 2.59.63 4.14 1.73 4.14 4.19 0 2.05-1.47 3.32-3.14 3.66z" />
                        </svg>
                      </div>
                    </div>

                    <section id="section-info" className="space-y-8 scroll-mt-40">
                      <div className="border-l-8 border-tennis-green pl-6">
                        <LanguageLabel en={TEXT.info.en} nl={TEXT.info.nl} required className="text-xl" />
                      </div>

                      <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div id="field-firstName">
                          <InputField
                            en={TEXT.firstName.en} nl={TEXT.firstName.nl} required maxLength={50}
                            placeholder={TEXT.placeholders.firstName}
                            value={userData.firstName}
                            error={errors.firstName}
                            onChange={(val) => setUserData((prev) => ({ ...prev, firstName: val }))}
                          />
                        </div>

                        <div id="field-lastName">
                          <InputField
                            en={TEXT.lastName.en} nl={TEXT.lastName.nl} required maxLength={50}
                            placeholder={TEXT.placeholders.lastName}
                            value={userData.lastName}
                            error={errors.lastName}
                            onChange={(val) => setUserData((prev) => ({ ...prev, lastName: val }))}
                          />
                        </div>
                      </div>

                      <div id="field-dob">
                        <LanguageLabel en={TEXT.dob.en} nl={TEXT.dob.nl} required />
                        <div className="grid grid-cols-3 gap-4">
                          <select
                            value={userData.dobDay}
                            onChange={(e) => setUserData((prev) => ({ ...prev, dobDay: e.target.value }))}
                            className="p-3 border-2 rounded-xl outline-none bg-white text-black border-gray-200 shadow-sm focus:border-tennis-green focus:ring-4 focus:ring-tennis-green/10 transition-all appearance-none"
                          >
                            <option value="">{TEXT.day.en} / {TEXT.day.nl}</option>
                            {days.map((d) => <option key={d} value={d}>{d}</option>)}
                          </select>

                          <select
                            value={userData.dobMonth}
                            onChange={(e) => setUserData((prev) => ({ ...prev, dobMonth: e.target.value }))}
                            className="p-3 border-2 rounded-xl outline-none bg-white text-black border-gray-200 shadow-sm focus:border-tennis-green focus:ring-4 focus:ring-tennis-green/10 transition-all appearance-none"
                          >
                            <option value="">{TEXT.month.en} / {TEXT.month.nl}</option>
                            {months.map((m) => <option key={m} value={m}>{m}</option>)}
                          </select>

                          <select
                            value={userData.dobYear}
                            onChange={(e) => setUserData((prev) => ({ ...prev, dobYear: e.target.value }))}
                            className="p-3 border-2 rounded-xl outline-none bg-white text-black border-gray-200 shadow-sm focus:border-tennis-green focus:ring-4 focus:ring-tennis-green/10 transition-all appearance-none"
                          >
                            <option value="">{TEXT.year.en} / {TEXT.year.nl}</option>
                            {years.map((y) => <option key={y} value={y}>{y}</option>)}
                          </select>
                        </div>

                        {errors.dob && <p className="text-red-600 text-xs mt-2 font-bold">{errors.dob}</p>}
                      </div>
                    </section>

                    <section id="section-address" className="space-y-8 scroll-mt-40">
                      <div className="border-l-8 border-tennis-green pl-6">
                        <LanguageLabel en={TEXT.addressSec.en} nl={TEXT.addressSec.nl} required className="text-xl" />
                      </div>

                      <div className="grid grid-cols-4 gap-6">
                        <div className="col-span-3" id="field-street">
                          <InputField
                            en={TEXT.street.en} nl={TEXT.street.nl} placeholder={TEXT.placeholders.street}
                            value={userData.street}
                            error={errors.street}
                            onChange={(val) => setUserData((prev) => ({ ...prev, street: val }))}
                          />
                        </div>

                        <div id="field-houseNumber">
                          <InputField
                            en={TEXT.houseNumber.en} nl={TEXT.houseNumber.nl} placeholder={TEXT.placeholders.houseNumber}
                            value={userData.houseNumber}
                            error={errors.houseNumber}
                            onChange={(val) => setUserData((prev) => ({ ...prev, houseNumber: val }))}
                          />
                        </div>
                      </div>

                      <div className="grid grid-cols-2 gap-6">
                        <div id="field-postcode">
                          <InputField
                            en={TEXT.postcode.en} nl={TEXT.postcode.nl} placeholder={TEXT.placeholders.postcode}
                            value={userData.postcode}
                            error={errors.postcode}
                            onChange={(val) => setUserData((prev) => ({ ...prev, postcode: val }))}
                          />
                        </div>

                        <div id="field-city">
                          <InputField
                            en={TEXT.city.en} nl={TEXT.city.nl} placeholder={TEXT.placeholders.city}
                            value={userData.city}
                            error={errors.city}
                            onChange={(val) => setUserData((prev) => ({ ...prev, city: val }))}
                          />
                        </div>
                      </div>

                      <div id="field-email">
                        <InputField
                          en={TEXT.email.en} nl={TEXT.email.nl} required type="email" placeholder={TEXT.placeholders.email}
                          value={userData.email}
                          error={errors.email}
                          onChange={(val) => setUserData((prev) => ({ ...prev, email: val }))}
                        />
                      </div>

                      <div id="field-phone">
                        <InputField
                          en={TEXT.phone.en} nl={TEXT.phone.nl} placeholder={TEXT.placeholders.phone}
                          value={userData.phone || ""}
                          onChange={(val) => setUserData((prev) => ({ ...prev, phone: val }))}
                        />
                      </div>
                    </section>

                    <section id="section-payment" className="space-y-8 scroll-mt-40 pt-16 border-t-2 border-gray-100">
                      <div className="border-l-8 border-tennis-green pl-6">
                        <LanguageLabel en={TEXT.paymentSec.en} nl={TEXT.paymentSec.nl} required className="text-xl" />
                      </div>

                      {appState === "FAILED" && (
                        <div className="bg-red-50 border-2 border-red-500 p-6 rounded-2xl text-red-700 flex items-start space-x-4">
                          <svg className="w-6 h-6 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                            <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clipRule="evenodd"/>
                          </svg>
                          <div>
                            <p className="font-bold mb-1">{TEXT.failed.en} / {TEXT.failed.nl}</p>
                            <p className="text-sm opacity-90">{paymentErrorMessage}</p>
                          </div>
                        </div>
                      )}

                      <div id="field-card" className="bg-gray-50 p-6 rounded-2xl border-2 border-gray-100">
                        <LanguageLabel en={TEXT.cardNumber.en} nl={TEXT.cardNumber.nl} required className="mb-4" />
                        <div id="stripe-card-element" className="mt-2"></div>
                        <div className="mt-6 flex items-center justify-between">
                          <p className="text-[10px] text-gray-400 font-bold uppercase tracking-widest flex items-center">
                            <svg className="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                              <path fillRule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clipRule="evenodd"/>
                            </svg>
                            Encrypted SSL Security
                          </p>
                          <div className="flex space-x-2 grayscale opacity-50">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" className="h-4" alt="Visa" />
                            <img src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Mastercard-logo.svg" className="h-4" alt="Mastercard" />
                          </div>
                        </div>
                      </div>

                      <div className="pt-10">
                        <button
                          disabled={appState === "PROCESSING"}
                          onClick={handleProcessPayment}
                          className={`w-full text-white py-6 rounded-2xl font-black text-2xl shadow-2xl transition-all transform active:scale-[0.99] ${
                            appState === "PROCESSING"
                              ? "bg-gray-400 cursor-not-allowed"
                              : "tennis-green tennis-green-hover"
                          }`}
                        >
                          {appState === "PROCESSING"
                            ? TEXT.processing.en
                            : (TEXT.payButton.en + ` (€${fee},00)`)}
                        </button>

                        <p className="text-center text-gray-400 text-xs mt-6 px-10 leading-relaxed italic">
                          By clicking the button above, you agree to the Rozenrust Tennis Club terms and conditions and privacy policy.
                        </p>
                      </div>
                    </section>

                  </div>
                </div>
              </div>
            </main>

            <footer className="mt-20 text-center text-gray-400 text-sm pb-12 space-y-2">
              <p className="font-semibold text-gray-500">Rozenrust Tennis Club Portal</p>
              <p>&copy; {new Date().getFullYear()} All rights reserved. Professional Member Management System.</p>
            </footer>
          </div>
        );
      };

      /*************************
       * RENDER
       *************************/
      ReactDOM.render(<App />, document.getElementById("root"));
    })();
  </script>
</body>
</html>
